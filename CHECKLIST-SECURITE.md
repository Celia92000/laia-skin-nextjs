# ‚úÖ Checklist S√©curit√© - LAIA

## üéØ Avant de d√©ployer en PRODUCTION

### Authentification & Mots de passe
- [x] JWT_SECRET renouvel√© (64 bytes minimum)
- [x] Mot de passe Super Admin chang√©
- [x] Mot de passe Admin chang√©
- [x] Validation de mots de passe forts activ√©e
- [x] V√©rification email impl√©ment√©e
- [ ] Champ `emailVerified` ajout√© au schema Prisma
- [ ] Connexion bloqu√©e si email non v√©rifi√©
- [ ] Rate limiting sur login (5 tentatives / 15 min)
- [ ] 2FA activ√© pour Super Admin

### Paiements
- [ ] ‚ö†Ô∏è **CRITIQUE** : Stripe en mode PRODUCTION (sk_live_)
- [ ] Webhooks Stripe configur√©s
- [ ] Tests de paiement r√©els effectu√©s
- [ ] Gestion des remboursements test√©e
- [ ] 3D Secure activ√©

### Int√©grations externes
- [ ] ‚ö†Ô∏è Token WhatsApp renouvel√©
- [ ] ‚ö†Ô∏è Token Instagram renouvel√© (expire 16/12/2025)
- [ ] ‚ö†Ô∏è Token Facebook renouvel√© (expire 11/12/2025)
- [ ] Auto-renewal des tokens configur√©
- [ ] Webhooks WhatsApp s√©curis√©s

### Email
- [x] Resend API Key configur√©e
- [ ] Domaine v√©rifi√© dans Resend
- [ ] Templates emails test√©s
- [ ] Webhooks delivery status configur√©s

### Monitoring & Logs
- [ ] Sentry DSN configur√©
- [ ] Sentry Auth Token configur√©
- [ ] Logs d'audit activ√©s
- [ ] Alertes erreurs critiques configur√©es
- [ ] Uptime monitoring actif

### Fichiers & Configuration
- [x] `.env.local` dans `.gitignore`
- [ ] `.env.production` cr√©√© et s√©curis√©
- [ ] Aucun secret dans le code
- [ ] Variables d'environnement Vercel configur√©es
- [ ] Backup de `.env` dans gestionnaire de mots de passe

### Base de donn√©es
- [ ] Backups automatiques configur√©s
- [ ] Chiffrement at-rest activ√©
- [ ] Acc√®s limit√© par IP si possible
- [ ] Index de performance cr√©√©s
- [ ] Plan de restore test√©

### Tests de s√©curit√©
- [ ] Audit de s√©curit√© complet effectu√© (`npx tsx scripts/security-check.ts`)
- [ ] Tests de p√©n√©tration effectu√©s
- [ ] Scan de vuln√©rabilit√©s (npm audit)
- [ ] Review du code sensible
- [ ] Test de r√©cup√©ration apr√®s incident

---

## üö® Checklist d√©ploiement IMM√âDIAT

### Avant de lancer le site :

1. **Stripe Production**
   ```bash
   # V√©rifier .env.local
   grep "STRIPE_SECRET_KEY" .env.local
   # Doit commencer par sk_live_ et NON sk_test_
   ```

2. **Tokens Meta renouvel√©s**
   ```bash
   # V√©rifier tokens
   grep "WHATSAPP_ACCESS_TOKEN" .env.local
   grep "INSTAGRAM_ACCESS_TOKEN" .env.local
   grep "FACEBOOK_PAGE_ACCESS_TOKEN" .env.local
   # Tous doivent √™tre r√©cents et valides
   ```

3. **Email verification obligatoire**
   ```typescript
   // Dans /api/auth/login/route.ts
   if (!user.emailVerified) {
     return NextResponse.json({ error: 'Email non v√©rifi√©' }, { status: 403 });
   }
   ```

4. **Audit final**
   ```bash
   npx tsx scripts/security-check.ts
   # Doit afficher 0 probl√®me CRITIQUE et 0 probl√®me HAUTE priorit√©
   ```

5. **Tests de connexion**
   - [ ] Super Admin peut se connecter
   - [ ] Admin peut se connecter
   - [ ] Client ne peut pas se connecter sans email v√©rifi√©
   - [ ] Email de v√©rification est bien re√ßu
   - [ ] Lien de v√©rification fonctionne

6. **Tests de paiement**
   - [ ] Paiement carte bancaire fonctionne
   - [ ] SEPA fonctionne
   - [ ] Webhooks Stripe re√ßus
   - [ ] Remboursement possible
   - [ ] Facture g√©n√©r√©e

---

## üîÑ Checklist maintenance MENSUELLE

- [ ] V√©rifier expiration tokens Meta
- [ ] Renouveler tokens si < 15 jours
- [ ] Changer les mots de passe sensibles
- [ ] Ex√©cuter audit de s√©curit√©
- [ ] V√©rifier logs d'audit
- [ ] Analyser tentatives de connexion √©chou√©es
- [ ] Mettre √† jour d√©pendances npm
- [ ] Scanner vuln√©rabilit√©s (`npm audit`)
- [ ] V√©rifier backups base de donn√©es
- [ ] Tester plan de r√©cup√©ration

---

## üìä Score de s√©curit√© cible

### Minimum pour production : 80/100

**R√©partition** :
- Authentication (20/20) - ‚úÖ Fait
- Authorization (15/15) - ‚úÖ Fait
- Data Protection (15/15) - ‚ö†Ô∏è Partiel (12/15)
- Monitoring (10/10) - ‚ö†Ô∏è Partiel (5/10)
- API Security (15/15) - ‚úÖ Fait
- Infrastructure (15/15) - ‚ö†Ô∏è Partiel (10/15)
- Compliance (10/10) - ‚ö†Ô∏è Partiel (6/10)

**Score actuel estim√©** : 70/100
**Actions prioritaires pour atteindre 80** :
1. Stripe production (+ 5 points)
2. Rate limiting (+ 3 points)
3. Sentry configur√© (+ 2 points)

---

## üéì Formation √©quipe

Avant le lancement, s'assurer que :

- [ ] Toute l'√©quipe conna√Æt les nouveaux mots de passe
- [ ] Proc√©dure de reset password document√©e
- [ ] Proc√©dure en cas d'incident d√©finie
- [ ] Contacts support disponibles
- [ ] Documentation mise √† jour

---

## üìù Notes importantes

‚ö†Ô∏è **Ne JAMAIS** :
- Commit `.env.local` dans Git
- Partager mots de passe par email/Slack
- Utiliser production pour tester
- Ignorer les alertes Sentry
- D√©ployer sans backup

‚úÖ **TOUJOURS** :
- Tester en local d'abord
- Faire un backup avant changement
- Documenter les modifications
- V√©rifier les logs apr√®s d√©ploiement
- Avoir un plan de rollback

---

**Valid√© par** : _______________
**Date** : _______________
**Pr√™t pour production** : ‚¨ú OUI  ‚¨ú NON

**Probl√®mes bloquants restants** :
1. _______________________________
2. _______________________________
3. _______________________________
